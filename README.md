# cocos-creator_find-clusters

Этот проект представляет собой игру Cocos Creator, которая определяет и визуально отмечает кластеры блоков одного цвета в сетке. Размеры сетки, количество цветовых схем и минимальный размер кластера можно настраивать.

## Возможности и функциональность

- **Генерация динамической сетки:** создает сетку из цветных блоков на основе указанных пользователем размеров (M x N).
- **Настраиваемые цветовые схемы:** позволяют указать количество цветовых схем (X), которые будут использоваться для блоков.
- **Обнаружение кластеров:** использует алгоритм поиска в глубину (DFS) для поиска кластеров смежных блоков одинакового цвета.
- **Минимальный размер кластера:** настраиваемый минимальный размер (Y) для идентифицируемых кластеров. Кластеры меньше этого размера игнорируются.
- **Визуальная маркировка:** выделяет обнаруженные кластеры с помощью масштабируемой анимации, отличая их от обычных блоков.
- **Предварительный просмотр в редакторе:** сетку и выделение кластеров можно предварительно просмотреть в редакторе Cocos Creator.
- **Поля ввода:** позволяют пользователям изменять параметры сетки (M, N, X, Y).

## Технологический стек

- **Cocos Creator:** игровой движок версии 3.8.7, используемый для разработки.
- **TypeScript:** язык программирования, используемый для написания скриптов.
- **Depth-First Search (DFS):** алгоритм обнаружения кластеров, реализованный в `assets/Scripts/utils/ClusterFinderDFS.ts`.

## Инструкция по установке

1.  Клонировать репозиторий:
    ```bash
    git clone https://github.com/Efim-Kapliy/cocos-creator_find-clusters.git
    ```
2.  Откройте проект в Cocos Creator.
3.  Убедитесь, что в Cocos Creator установлены все необходимые модули.

## Руководство по использованию

1.  **Открыть сцену:** Откройте основную сцену в редакторе Cocos Creator.
2.  **Настройте менеджер игры:** выберите `GameManager` узел в иерархии сцены.
3.  **Настройка параметров:** на панели «Инспектор» вы можете настроить следующие параметры:
    - `M`: Ширина сетки (количество столбцов).
    - `N`: Высота сетки (количество строк).
    - `X`: Количество цветовых схем для блоков.
    - `Y`: Минимальный размер кластеров для выделения.
    - `blockPrefab`: префаб, используемый для генерации блоков. Этот префаб должен соответствовать вашему префабу блока.
4.  **Запустите сцену:** Нажмите кнопку "Play" в Cocos Creator, чтобы запустить сцену.
5.  **Менеджер отмеченных блоков:** выберите `MarkedBlocksManager` узел в иерархии сцены.
    - `blockPrefab`: Префаб, используемый для маркировки блоков. В качестве префаба следует выбрать префаб блока с маркированной анимацией.
6.  **Использование EditBox:** используйте элементы управления EditBox для изменения параметров M, N, X и Y. Нажмите кнопку «Start», чтобы применить новые параметры.

## Структура кода

- `assets/Scripts/GameControls.ts`: Обрабатывает пользовательский ввод через `EditBox` компоненты и отправляет обновленные параметры в `GameManager`.
- `assets/Scripts/GameManager.ts`: Генерирует сетку блоков, управляет состоянием игры и обрабатывает обновления параметров. Основная логика создания поля блока находится здесь. Используется `SeededRandom` для предсказуемой случайной генерации. Использует `BlockFactory` для создания экземпляров префабов блоков.
- `assets/Scripts/MarkedBlocksManager.ts`: Обнаруживает кластеры с помощью `ClusterFinderDFS` и визуально отмечает их на сетке с помощью `BlockFactory`.
- `assets/Scripts/blocks/`: Содержит скрипты, связанные с созданием и управлением блоками.
  - `Block.ts`: Абстрактный базовый класс для блоков.
  - `BlockFactory.ts`: Фабричный класс для создания различных типов блоков (простых и маркированных).
  - `SimpleBlock.ts`: Реализация простого блока.
  - `MarkedBlock.ts`: Реализация маркированного блока с анимацией масштабирования.
- `assets/Scripts/utils/`: Содержит служебные классы.
  - `ClusterFinderDFS.ts`: Реализует алгоритм поиска в глубину для поиска кластеров. Настраиваемые параметры для `minClusterSize` и `includeDiagonals`.
  - `RandomColorGenerator.ts`: Генерирует набор случайных цветов.
  - `SeededRandom.ts`: Предоставляет генератор случайных чисел с начальным значением для получения предсказуемых результатов.
- `assets/Scripts/types/`: Содержит определения типов.
  - `blocks.ts`: Определяет `ColorType` как `number[]`.

## API Документация

- **`GameManager.addScore(AddScoreType)`:** Обновляет параметры сетки (M, N, X, Y) и запускает повторную визуализацию сетки.
  - `AddScoreType`: Объект со следующими свойствами:
    - `M`: Number (ширина сетки).
    - `N`: Number (высота сетки).
    - `X`: Number (цветовые схемы).
    - `Y`: Number (Минимальный размер кластера).
- **`ClusterFinderDFS.findClusters()`:** находит все кластеры в сетке, соответствующие минимальному размеру. Возвращает `Position[][]`, где каждый `Position[]` — кластер, а каждый `Position` — `[row, col]` координата в сетке.
- **`BlockFactory.createBlock(CreateBlockType)`:** Создает блок на основе указанного типа и параметров.
  - `CreateBlockType`:
    - `blockType`: "simple" | "marked"
    - `prefab`: Prefab
    - `parent`: Node
    - `positionX`: number
    - `positionY`: number
    - `colorRGB`: ColorType

## Контактная информация/информация о поддержке

For questions or support, please contact [Efim-Kapliy](https://github.com/Efim-Kapliy) via GitHub.
